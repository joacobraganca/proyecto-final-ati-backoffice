"use strict";(self.webpackChunkbackoffice=self.webpackChunkbackoffice||[]).push([[817],{9817:(ne,w,m)=>{m.r(w),m.d(w,{DashboardModule:()=>oe});var _=m(8583),J=m(416),S=m(4655),t=m(7716),N=m(1841);let A=(()=>{class i{constructor(e){this.http=e,this.hospitals=[],this.pathologies=[],this.partnerServices=[],this.emertencyServices=[],this.token=localStorage.getItem("access_token")||""}setHealthHome(e){this.healthHome=e}setHospitals(e){this.hospitals=e}setPathologies(e){this.pathologies=e}setPartnerServices(e){this.partnerServices=e}setEmertencyServices(e){this.emertencyServices=e}getHealthHomeLocal(){return this.healthHome}getHospitalsLocal(){return this.hospitals}getPathologiesLocal(){return this.pathologies}getPartnerServicesLocal(){return this.partnerServices}getEmertencyServicesLocal(){return this.emertencyServices}getHospital(){return this.http.get("https://healthhomeapi.herokuapp.com/api/hospital",{headers:{"Content-type":"application/json",Authorization:this.token},observe:"response"})}getPathologies(){return this.http.get("https://healthhomeapi.herokuapp.com/api/pathologies",{headers:{"Content-type":"application/json",Authorization:this.token},observe:"response"})}getPartnerService(){return this.http.get("https://healthhomeapi.herokuapp.com/api/partnerService",{headers:{"Content-type":"application/json",Authorization:this.token},observe:"response"})}getEmergencyService(){return this.http.get("https://healthhomeapi.herokuapp.com/api/emergencyService",{headers:{"Content-type":"application/json",Authorization:this.token},observe:"response"})}getHealthHomes(){return this.http.get("https://healthhomeapi.herokuapp.com/api/healthHome/all",{headers:{"Content-type":"application/json",Authorization:this.token},observe:"response"})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(N.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),T=(()=>{class i{constructor(e){this.http=e,this.patients=[],this.token=localStorage.getItem("access_token")||""}setPatients(e){this.patients=e}getPatientsLocal(){return this.patients}getPatientsByHome(e){return this.http.get(`https://healthhomeapi.herokuapp.com/api/patient/homeId?_id=${e}`,{headers:{"Content-type":"application/json",Authorization:this.token},observe:"response"})}deletePatientById(e){return this.http.delete(`https://healthhomeapi.herokuapp.com/api/patient?document=${e}`,{headers:{"Content-type":"application/json",Authorization:this.token},responseType:"text",observe:"response"})}createPatient(e){const o={"Content-type":"application/json",Authorization:this.token},a=JSON.stringify(e);return this.http.post("https://healthhomeapi.herokuapp.com/api/patient",a,{headers:o,observe:"response",responseType:"text"})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(N.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var b=m(3071),L=m(2522),C=m(1095),x=m(6627);let j=(()=>{class i{constructor(e,o,a,s){this.router=e,this.patientService=o,this.userService=a,this.miscService=s,this.userName="",this.healthHomeName=""}ngOnInit(){this.userName=this.userService.getUserName()}getHealthHomeName(){var e;return null===(e=this.miscService.getHealthHomeLocal())||void 0===e?void 0:e.name}logout(){this.patientService.setPatients([]),localStorage.removeItem("access_token"),this.router.navigate([""])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(S.F0),t.Y36(T),t.Y36(b.K),t.Y36(A))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-navbar"]],decls:14,vars:2,consts:[["color","primary"],[1,"example-spacer"],["mat-button","","routerLink","tasks"],["mat-button","","routerLink","patients"],["mat-icon-button","","routerLink","",1,"primary",2,"margin-left","16px"],[3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-toolbar",0),t.TgZ(1,"h1"),t._uU(2),t.qZA(),t._UZ(3,"span",1),t.TgZ(4,"button",2),t._uU(5,"Tareas"),t.qZA(),t.TgZ(6,"button",3),t._uU(7,"Pacientes"),t.qZA(),t._UZ(8,"span",1),t.TgZ(9,"h1"),t._uU(10),t.qZA(),t.TgZ(11,"button",4),t.TgZ(12,"mat-icon",5),t.NdJ("click",function(){return o.logout()}),t._uU(13,"logout"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Oqu(o.getHealthHomeName()),t.xp6(8),t.hij("Sesi\xf3n: ",o.userName,""))},directives:[L.Ye,C.lW,S.rH,x.Hw],styles:[".example-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]}),i})(),G=(()=>{class i{constructor(e,o,a){this.miscSevice=e,this.patientService=o,this.userService=a}ngOnInit(){this.getHospitals(),this.getPathologies(),this.getPartnerService(),this.getEmergencyService(),this.getPatients(),this.getNurses(),this.getHealthHomesNames()}getHospitals(){this.miscSevice.getHospital().subscribe(e=>{200===e.status&&this.miscSevice.setHospitals(e.body||[])},e=>{console.log(e)})}getPathologies(){this.miscSevice.getPathologies().subscribe(e=>{200===e.status&&this.miscSevice.setPathologies(e.body||[])},e=>{console.log(e)})}getPartnerService(){this.miscSevice.getPartnerService().subscribe(e=>{200===e.status&&this.miscSevice.setPartnerServices(e.body||[])},e=>{console.log(e)})}getEmergencyService(){this.miscSevice.getEmergencyService().subscribe(e=>{200===e.status&&this.miscSevice.setEmertencyServices(e.body||[])},e=>{console.log(e)})}getPatients(){this.patientService.getPatientsByHome(this.userService.getHealthHome()).subscribe(e=>{200===e.status&&this.patientService.setPatients(e.body||[])},e=>{console.log(e)})}getNurses(){this.userService.getNursesByHome(this.userService.getHealthHome()).subscribe(e=>{200===e.status&&this.userService.setNurses(e.body||[])},e=>{console.log(e)})}getHealthHomesNames(){let e=this.userService.getHealthHome();this.miscSevice.getHealthHomes().subscribe(o=>{var a;if(200===o.status){let s=null===(a=o.body)||void 0===a?void 0:a.find(r=>r._id===e);s&&this.miscSevice.setHealthHome(s)}},o=>{console.log(o)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(A),t.Y36(T),t.Y36(b.K))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard"]],decls:2,vars:0,template:function(e,o){1&e&&(t._UZ(0,"app-navbar"),t._UZ(1,"router-outlet"))},directives:[j,S.lC],styles:[".content[_ngcontent-%COMP%]{padding:20px}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}"]}),i})();var E=m(6215),l=m(3679),g=m(2238),P=m(7832),q=m(8295),O=m(9983),H=m(7441),F=m(2458);function B(i,n){1&i&&t._uU(0,"Datos personales")}function $(i,n){1&i&&(t.TgZ(0,"div"),t.TgZ(1,"h4"),t._uU(2,"Rellene todos los campos"),t.qZA(),t.qZA())}function z(i,n){1&i&&t._uU(0,"Datos m\xe9dicos")}function R(i,n){if(1&i&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e.name)}}function X(i,n){if(1&i&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e.name)}}function K(i,n){if(1&i&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e.name)}}function W(i,n){if(1&i&&(t.TgZ(0,"mat-option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e.name)}}function V(i,n){1&i&&(t.TgZ(0,"div"),t.TgZ(1,"h4"),t._uU(2,"Rellene todos los campos"),t.qZA(),t.qZA())}function tt(i,n){1&i&&t._uU(0,"Contactos")}function et(i,n){if(1&i&&(t.TgZ(0,"div",26),t.TgZ(1,"div",27),t.TgZ(2,"mat-form-field",28),t._UZ(3,"input",29),t.qZA(),t.TgZ(4,"mat-form-field",28),t._UZ(5,"input",30),t.qZA(),t.qZA(),t.qZA()),2&i){const e=n.index;t.xp6(1),t.Q6J("formGroupName",e)}}function it(i,n){1&i&&(t.TgZ(0,"div"),t.TgZ(1,"h4"),t._uU(2,"Ingrese al menos 1 contacto"),t.qZA(),t.qZA())}let ot=(()=>{class i{constructor(e,o,a,s,r){this.fb=e,this.patientService=o,this.miscService=a,this.userService=s,this.parentData=r,this.data=[{contactName:"",contactPhone:""}],this.dataSource=new E.X([]),this.displayColumns=["contactName","contactPhone"],this.rows=this.fb.array([]),this.thirdFormGroup=this.fb.group({contacts:this.rows}),this.isEditable=!0,this.firstStepInvalid=!1,this.secondStepInvalid=!1,this.thirdStepInvalid=!1,this.hospitalsList=[],this.pathologiesList=[],this.emergencyServicesList=[],this.partnerServicesList=[],this.toppingList=["Extra cheese","Mushroom","Onion","Pepperoni","Sausage","Tomato"],this.firstFormGroup=this.fb.group({document:["",l.kI.required],name:["",l.kI.required]}),this.secondFormGroup=this.fb.group({mutualist:[],emergencyService:new l.NI,primaryDoctor:[],accompanying:new l.NI,pathologies:new l.NI,cares:[""]})}validateFirstStep(){var e,o;return!(""!==(null===(e=this.firstFormGroup.get("name"))||void 0===e?void 0:e.value)&&""!==(null===(o=this.firstFormGroup.get("document"))||void 0===o?void 0:o.value))}validateSecondStep(){var e,o,a,s,r,c;return!(null!==(null===(e=this.secondFormGroup.get("mutualist"))||void 0===e?void 0:e.value)&&null!==(null===(o=this.secondFormGroup.get("emergencyService"))||void 0===o?void 0:o.value)&&null!==(null===(a=this.secondFormGroup.get("primaryDoctor"))||void 0===a?void 0:a.value)&&null!==(null===(s=this.secondFormGroup.get("accompanying"))||void 0===s?void 0:s.value)&&(null===(r=this.secondFormGroup.get("pathologies"))||void 0===r?void 0:r.value.length)>0&&""!==(null===(c=this.secondFormGroup.get("cares"))||void 0===c?void 0:c.value))}validateThirdStep(){var e,o,a;return!((null===(e=this.thirdFormGroup.get("contacts"))||void 0===e?void 0:e.value.length)>0&&null!==(null===(o=this.thirdFormGroup.get("contacts"))||void 0===o?void 0:o.value[0].contactName)&&null!==(null===(a=this.thirdFormGroup.get("contacts"))||void 0===a?void 0:a.value[0].contactPhone))}ngOnInit(){this.data.forEach(e=>this.addRow(e,!1)),this.updateView(),(0===this.hospitalsList.length||0===this.pathologiesList.length||0===this.partnerServicesList.length||0===this.emergencyServicesList.length)&&(this.hospitalsList=this.miscService.getHospitalsLocal(),this.pathologiesList=this.miscService.getPathologiesLocal(),this.partnerServicesList=this.miscService.getPartnerServicesLocal(),this.emergencyServicesList=this.miscService.getEmertencyServicesLocal())}finishSteps(e){let o=4;this.validateThirdStep()&&(this.thirdStepInvalid=!0,o=2),this.validateSecondStep()&&(this.secondStepInvalid=!0,o=1),this.validateFirstStep()&&(this.firstStepInvalid=!0,o=0),o<4?e.selectedIndex=o:this.savePatient()}savePatient(){var e,o,a,s,r,c,h,f,u;let d=null===(e=this.thirdFormGroup.get("contacts"))||void 0===e?void 0:e.value,y=[];d.forEach(Z=>{y.push({name:Z.contactName,phone:Z.contactPhone})});let U={name:null===(o=this.firstFormGroup.get("name"))||void 0===o?void 0:o.value,document:null===(a=this.firstFormGroup.get("document"))||void 0===a?void 0:a.value,hospital:null===(s=this.secondFormGroup.get("mutualist"))||void 0===s?void 0:s.value._id,emergencyService:null===(r=this.secondFormGroup.get("emergencyService"))||void 0===r?void 0:r.value._id,gpDoctor:null===(c=this.secondFormGroup.get("primaryDoctor"))||void 0===c?void 0:c.value,partnerService:null===(h=this.secondFormGroup.get("accompanying"))||void 0===h?void 0:h.value._id,pathologies:null===(f=this.secondFormGroup.get("pathologies"))||void 0===f?void 0:f.value.map(Z=>Z._id),caresAndComments:null===(u=this.secondFormGroup.get("cares"))||void 0===u?void 0:u.value,assignedHealthHome:this.userService.getHealthHome(),contacts:y,admissionDate:this.formatDate()};this.patientService.createPatient(U).subscribe(Z=>{this.patientService.getPatientsByHome(this.userService.getHealthHome()).subscribe(Y=>{this.patientService.setPatients(Y.body||[]),this.parentData.closeDialog()},Y=>{console.log(Y)})},Z=>{console.log(Z)})}addRow(e,o){const a=this.fb.group({contactName:[e&&e.contactName?e.contactName:null,[]],contactPhone:[e&&e.contactPhone?e.contactPhone:null,[]]});this.rows.push(a),o||this.updateView()}updateView(){this.dataSource.next(this.rows.controls)}formatDate(){var e=new Date,o=""+(e.getMonth()+1),a=""+e.getDate(),s=e.getFullYear();return o.length<2&&(o="0"+o),a.length<2&&(a="0"+a),[s,o,a].join("/")}validateCI(e){let o=e.target.value;if(o.length>5){o=this.clean_ci(o);var a=o[o.length-1];o=o.replace(/[0-9]$/,""),a==this.validation_digit(o)?this.firstFormGroup.controls.document.setErrors(null):this.firstFormGroup.controls.document.setErrors({incorrect:!0})}}validation_digit(e){var o=0,a=0;if(e.length<=6)for(a=e.length;a<7;a++)e="0"+e;for(a=0;a<7;a++)o+=parseInt("2987634"[a])*parseInt(e[a])%10;return o%10==0?0:10-o%10}clean_ci(e){return e.replace(/\D/g,"")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(l.qu),t.Y36(T),t.Y36(A),t.Y36(b.K),t.Y36(g.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-crear-paciente"]],decls:71,vars:15,consts:[[1,"nav-1"],["mat-dialog-close",""],["linear",""],["stepper",""],[3,"stepControl","editable"],[3,"formGroup"],["matStepLabel",""],["appearance","fill",1,"input"],["matInput","","name","ci","formControlName","document","placeholder","Ej.: 1.234.567-8","autocomplete","off",3,"keyup"],["matInput","","formControlName","name","placeholder","Ej.: Luis Su\xe1rez","autocomplete","off"],[4,"ngIf"],["mat-button","","matStepperNext",""],["required","","name","mutualist","formControlName","mutualist"],[3,"value",4,"ngFor","ngForOf"],["matInput","","name","primaryDoctor","formControlName","primaryDoctor","placeholder","","autocomplete","off"],["required","","name","emergencyService","formControlName","emergencyService"],["required","","name","accompanying","formControlName","accompanying"],["formControlName","pathologies","multiple",""],["formControlName","cares","matInput","","placeholder","Dormir de lado."],[1,"nav-2"],["mat-button","","matStepperPrevious",""],["formArrayName","contacts",4,"ngFor","ngForOf"],[1,"row"],["mat-mini-fab","","color","primary",3,"click"],["mat-raised-button","","color","primary",3,"click"],[3,"value"],["formArrayName","contacts"],[1,"row",3,"formGroupName"],["appearance","fill",1,"input-half"],["matInput","","formControlName","contactName","placeholder","Nombre","autocomplete","off"],["type","number","matInput","","formControlName","contactPhone","placeholder","N\xfamero (099999999)","autocomplete","off"]],template:function(e,o){if(1&e){const a=t.EpF();t.TgZ(0,"div",0),t.TgZ(1,"mat-icon",1),t._uU(2,"cancel"),t.qZA(),t.qZA(),t.TgZ(3,"mat-stepper",2,3),t.TgZ(5,"mat-step",4),t.TgZ(6,"form",5),t.YNc(7,B,1,0,"ng-template",6),t.TgZ(8,"mat-form-field",7),t.TgZ(9,"mat-label"),t._uU(10,"N\xfamero de documento (C.I)"),t.qZA(),t.TgZ(11,"input",8),t.NdJ("keyup",function(r){return o.validateCI(r)}),t.qZA(),t.qZA(),t.TgZ(12,"mat-form-field",7),t.TgZ(13,"mat-label"),t._uU(14,"Nombre completo"),t.qZA(),t._UZ(15,"input",9),t.qZA(),t.YNc(16,$,3,0,"div",10),t.TgZ(17,"div",0),t.TgZ(18,"button",11),t._uU(19,"Siguiente"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"mat-step",4),t.TgZ(21,"form",5),t.YNc(22,z,1,0,"ng-template",6),t.TgZ(23,"mat-form-field",7),t.TgZ(24,"mat-label"),t._uU(25,"Mutualista:"),t.qZA(),t.TgZ(26,"mat-select",12),t.YNc(27,R,2,2,"mat-option",13),t.qZA(),t.qZA(),t.TgZ(28,"mat-form-field",7),t.TgZ(29,"mat-label"),t._uU(30,"M\xe9dico de cabecera"),t.qZA(),t._UZ(31,"input",14),t.qZA(),t.TgZ(32,"mat-form-field",7),t.TgZ(33,"mat-label"),t._uU(34,"Servicio de emergencia:"),t.qZA(),t.TgZ(35,"mat-select",15),t.YNc(36,X,2,2,"mat-option",13),t.qZA(),t.qZA(),t.TgZ(37,"mat-form-field",7),t.TgZ(38,"mat-label"),t._uU(39,"Servicio de acompa\xf1ante:"),t.qZA(),t.TgZ(40,"mat-select",16),t.YNc(41,K,2,2,"mat-option",13),t.qZA(),t.qZA(),t.TgZ(42,"mat-form-field",7),t.TgZ(43,"mat-label"),t._uU(44,"Patologias"),t.qZA(),t.TgZ(45,"mat-select",17),t.YNc(46,W,2,2,"mat-option",13),t.qZA(),t.qZA(),t.TgZ(47,"mat-form-field",7),t.TgZ(48,"mat-label"),t._uU(49,"Cuidados"),t.qZA(),t._UZ(50,"textarea",18),t.qZA(),t.TgZ(51,"div",19),t.TgZ(52,"button",20),t._uU(53,"Anterior"),t.qZA(),t.TgZ(54,"button",11),t._uU(55,"Siguiente"),t.qZA(),t.qZA(),t.YNc(56,V,3,0,"div",10),t.qZA(),t.qZA(),t.TgZ(57,"mat-step"),t.YNc(58,tt,1,0,"ng-template",6),t.TgZ(59,"form",5),t.YNc(60,et,6,1,"div",21),t.qZA(),t.TgZ(61,"div",22),t.TgZ(62,"button",23),t.NdJ("click",function(){return o.addRow()}),t.TgZ(63,"mat-icon"),t._uU(64,"add"),t.qZA(),t.qZA(),t.qZA(),t.YNc(65,it,3,0,"div",10),t.TgZ(66,"div",19),t.TgZ(67,"button",20),t._uU(68,"Anterior"),t.qZA(),t.TgZ(69,"button",24),t.NdJ("click",function(){t.CHM(a);const r=t.MAs(4);return o.finishSteps(r)}),t._uU(70," Guardar paciente "),t.qZA(),t.qZA(),t.qZA(),t.qZA()}2&e&&(t.xp6(5),t.Q6J("stepControl",o.firstFormGroup)("editable",o.isEditable),t.xp6(1),t.Q6J("formGroup",o.firstFormGroup),t.xp6(10),t.Q6J("ngIf",o.firstStepInvalid),t.xp6(4),t.Q6J("stepControl",o.secondFormGroup)("editable",o.isEditable),t.xp6(1),t.Q6J("formGroup",o.secondFormGroup),t.xp6(6),t.Q6J("ngForOf",o.hospitalsList),t.xp6(9),t.Q6J("ngForOf",o.emergencyServicesList),t.xp6(5),t.Q6J("ngForOf",o.partnerServicesList),t.xp6(5),t.Q6J("ngForOf",o.pathologiesList),t.xp6(10),t.Q6J("ngIf",o.secondStepInvalid),t.xp6(3),t.Q6J("formGroup",o.thirdFormGroup),t.xp6(1),t.Q6J("ngForOf",o.rows.controls),t.xp6(5),t.Q6J("ngIf",o.thirdStepInvalid))},directives:[x.Hw,g.ZT,P.Vq,P.C0,l._Y,l.JL,l.sg,P.VY,q.KE,q.hX,O.Nt,l.Fj,l.JJ,l.u,_.O5,C.lW,P.Ic,H.gD,l.Q7,_.sg,P.fd,F.ey,l.CE,l.x0,l.wV],styles:[".body[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%;align-items:center}form[_ngcontent-%COMP%]{padding-top:24px}.img[_ngcontent-%COMP%]{width:50%;border-radius:45%;margin-bottom:15px}.login-element-width[_ngcontent-%COMP%]{width:80%}.button[_ngcontent-%COMP%]{height:50px;margin:8px 8px 8px 0}.mat-stepper-horizontal[_ngcontent-%COMP%]{margin-top:8px}.input[_ngcontent-%COMP%]{width:100%}.input-half[_ngcontent-%COMP%]{width:47%}.row[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.nav-1[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.nav-2[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),i})();var k=m(5319),D=m(2468);function nt(i,n){1&i&&(t.TgZ(0,"button",4),t._uU(1,"Cerrar"),t.qZA())}function at(i,n){1&i&&(t.TgZ(0,"button",4),t._uU(1," Aceptar "),t.qZA())}let I=(()=>{class i{constructor(e){this.data=e,this.subscription=new k.w,this.mode="",this.title="",this.text=""}ngOnInit(){this.subscription=this.data.currentMode.subscribe(e=>this.mode=e),this.subscription=this.data.currentTitle.subscribe(e=>this.title=e),this.subscription=this.data.currentText.subscribe(e=>this.text=e)}ngOnDestroy(){this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(D.D))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dialog"]],decls:7,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","","mat-dialog-close","",4,"ngIf"],["mat-button","","mat-dialog-close",""]],template:function(e,o){1&e&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t._uU(3),t.qZA(),t.TgZ(4,"div",2),t.YNc(5,nt,2,0,"button",3),t.YNc(6,at,2,0,"button",3),t.qZA()),2&e&&(t.xp6(1),t.Oqu(o.title),t.xp6(2),t.hij(" ",o.text,"\n"),t.xp6(2),t.Q6J("ngIf","show"===o.mode),t.xp6(1),t.Q6J("ngIf","validate"===o.mode))},directives:[g.uh,g.xY,g.H8,_.O5,C.lW,g.ZT],styles:[""]}),i})();var p=m(2789);function st(i,n){1&i&&(t.TgZ(0,"div",5),t.TgZ(1,"h3"),t._uU(2,"No existen pacientes."),t.qZA(),t.qZA())}function rt(i,n){1&i&&(t.TgZ(0,"th",18),t._uU(1,"Nombre"),t.qZA())}function ct(i,n){if(1&i&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.Oqu(e.name)}}function lt(i,n){1&i&&(t.TgZ(0,"th",18),t._uU(1,"Documento"),t.qZA())}function mt(i,n){if(1&i&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.Oqu(e.document)}}function pt(i,n){1&i&&(t.TgZ(0,"th",18),t._uU(1,"M\xe9dico cabecera"),t.qZA())}function ut(i,n){if(1&i&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.Oqu(e.gpDoctor)}}function ht(i,n){1&i&&(t.TgZ(0,"th",18),t._uU(1,"Patologias"),t.qZA())}function dt(i,n){if(1&i&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.pathologiesList.join(", ")," ")}}function gt(i,n){1&i&&(t.TgZ(0,"th",18),t._uU(1,"Cuidados"),t.qZA())}function ft(i,n){if(1&i&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.caresAndComments," ")}}function _t(i,n){1&i&&(t.TgZ(0,"th",18),t._uU(1,"Contactos"),t.qZA())}function vt(i,n){if(1&i&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.Oqu(e.contacts.length)}}function Zt(i,n){1&i&&t._UZ(0,"th",18)}function Tt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"td",19),t.TgZ(1,"button",20,21),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).deletePatient(s.document)}),t.TgZ(3,"mat-icon",22),t._uU(4,"delete"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=n.$implicit;t.xp6(1),t.uIk("data-message-id",e._id)}}function bt(i,n){1&i&&t._UZ(0,"tr",23)}function Ct(i,n){1&i&&t._UZ(0,"tr",24)}function yt(i,n){if(1&i&&(t.TgZ(0,"table",6),t.ynx(1,7),t.YNc(2,rt,2,0,"th",8),t.YNc(3,ct,2,1,"td",9),t.BQk(),t.ynx(4,10),t.YNc(5,lt,2,0,"th",8),t.YNc(6,mt,2,1,"td",9),t.BQk(),t.ynx(7,11),t.YNc(8,pt,2,0,"th",8),t.YNc(9,ut,2,1,"td",9),t.BQk(),t.ynx(10,12),t.YNc(11,ht,2,0,"th",8),t.YNc(12,dt,2,1,"td",9),t.BQk(),t.ynx(13,13),t.YNc(14,gt,2,0,"th",8),t.YNc(15,ft,2,1,"td",9),t.BQk(),t.ynx(16,14),t.YNc(17,_t,2,0,"th",8),t.YNc(18,vt,2,1,"td",9),t.BQk(),t.ynx(19,15),t.YNc(20,Zt,1,0,"th",8),t.YNc(21,Tt,5,1,"td",9),t.BQk(),t.YNc(22,bt,1,0,"tr",16),t.YNc(23,Ct,1,0,"tr",17),t.qZA()),2&i){const e=t.oxw();t.Q6J("dataSource",e.pacientes),t.xp6(22),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}let St=(()=>{class i{constructor(e,o,a,s,r){this.patientService=e,this.dialog=o,this.userService=a,this.data=s,this.miscService=r,this.subscription=new k.w,this.mode="",this.title="",this.text="",this.displayedColumns=["nombre","documento","medicoCabecera","patologias","cuidados","contactos","delete"],this.pacientes=[]}ngOnInit(){this.getPatients(),this.subscription=this.data.currentMode.subscribe(e=>this.mode=e),this.subscription=this.data.currentTitle.subscribe(e=>this.title=e),this.subscription=this.data.currentText.subscribe(e=>this.text=e)}ngOnDestroy(){this.subscription.unsubscribe()}getPatients(){let e=this.patientService.getPatientsLocal(),o=[];e.forEach(a=>{var s,r,c;let h=a;h.mutualist=(null===(s=this.miscService.getHospitalsLocal().find(u=>u))||void 0===s?void 0:s.name)||"",h.emergencyService=(null===(r=this.miscService.getEmertencyServicesLocal().find(u=>u))||void 0===r?void 0:r.name)||"",h.partnerService=(null===(c=this.miscService.getPartnerServicesLocal().find(u=>u))||void 0===c?void 0:c.name)||"";let f=[];h.pathologies.forEach(u=>{var d;f.push((null===(d=this.miscService.getPathologiesLocal().filter(y=>y._id===u)[0])||void 0===d?void 0:d.name)||"")}),h.pathologiesList=f,o.push(h)}),this.pacientes=o}createPatient(){const e=this.dialog.open(ot,{height:"80%",width:"700px",data:{closeDialog:()=>{e.close()}}});e.afterClosed().subscribe(o=>{this.ngOnInit()})}closePatientDialog(){this.dialog.closeAll()}deletePatient(e){this.patientService.deletePatientById(e).subscribe(o=>{200===o.status&&this.patientService.getPatientsByHome(this.userService.getHealthHome()).subscribe(a=>{this.patientService.setPatients(a.body||[])},a=>{this.patientService.setPatients([]),console.log(a)}).add(()=>{this.data.changeDialog("show","\xc9xito","Se elimino al paciente satisfactoriamente."),this.dialog.open(I),this.ngOnInit()})})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T),t.Y36(g.uw),t.Y36(b.K),t.Y36(D.D),t.Y36(A))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-paciente"]],decls:9,vars:2,consts:[[1,"content"],[1,"row"],["mat-fab","","color","primary","aria-label","Crear paciente",3,"click"],["class","mensaje",4,"ngIf"],["mat-table","","class","mat-elevation-z8",3,"dataSource",4,"ngIf"],[1,"mensaje"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","nombre"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","documento"],["matColumnDef","medicoCabecera"],["matColumnDef","patologias"],["matColumnDef","cuidados"],["matColumnDef","contactos"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","",3,"click"],["element._id",""],["color","warn"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h1"),t._uU(3,"Pacientes"),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return o.createPatient()}),t.TgZ(5,"mat-icon"),t._uU(6,"add"),t.qZA(),t.qZA(),t.qZA(),t.YNc(7,st,3,0,"div",3),t.YNc(8,yt,24,3,"table",4),t.qZA()),2&e&&(t.xp6(7),t.Q6J("ngIf",0===o.pacientes.length),t.xp6(1),t.Q6J("ngIf",o.pacientes.length>0))},directives:[C.lW,x.Hw,_.O5,p.BZ,p.w1,p.fO,p.Dz,p.as,p.nj,p.ge,p.ev,p.XQ,p.Gk],styles:[".content[_ngcontent-%COMP%]{padding:20px}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}",".mensaje[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center}table[_ngcontent-%COMP%]{width:100%}"]}),i})();var v=(()=>{return(i=v||(v={})).pendiente="Pendiente",i.enCurso="En curso",i.cerrado="Cerrado",v;var i})();let M=(()=>{class i{constructor(e){this.http=e,this.token=localStorage.getItem("access_token")||""}getTaskByHome(e){return this.http.get(`https://healthhomeapi.herokuapp.com/api/task/homeId?_id=${e}`,{headers:{"Content-type":"application/json",Authorization:this.token},observe:"response"})}deleteTaskById(e){return this.http.delete(`https://healthhomeapi.herokuapp.com/api/task?_id=${e}`,{headers:{"Content-type":"application/json",Authorization:this.token},responseType:"text",observe:"response"})}createTask(e){const o={"Content-type":"application/json",Authorization:this.token},a=JSON.stringify(e);return this.http.post("https://healthhomeapi.herokuapp.com/api/task",a,{headers:o,observe:"response",responseType:"text"})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(N.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Q=m(3755),At=m(3220),xt=m(7539);function Pt(i,n){if(1&i&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&i){const e=n.$implicit,o=t.oxw();t.Q6J("value",e),t.xp6(1),t.hij(" ",o.statusList[e]," ")}}function qt(i,n){if(1&i&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e.name)}}function Nt(i,n){if(1&i&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e.name)}}let Ut=(()=>{class i{constructor(e,o,a,s,r,c){this.http=e,this.fb=o,this.userService=a,this.patientService=s,this.taskService=r,this.parentData=c,this.enumKeys=Object.keys(v),this.statusList=v,this.priority=!1,this.patientsList=[],this.nursesList=[],this.disabled=!1,this.showSpinners=!0,this.showSeconds=!1,this.touchUi=!1,this.enableMeridian=!1,this.stepHour=1,this.stepMinute=1,this.taskFormGroup=this.fb.group({title:["",l.kI.required],description:[""],date:["",l.kI.required],statusTask:[],nurseSel:[void 0],patientSel:[],priority:[!1]})}ngOnInit(){this.getPatients(),this.getNurses()}getPatients(){this.patientService.getPatientsByHome(this.userService.getHealthHome()).subscribe(e=>{if(200===e.status&&null!==e.body){let o=[];e.body.map(a=>{o.push({_id:a._id,name:a.name})}),this.patientsList=o}},e=>{console.log(e)})}getNurses(){this.userService.getNursesByHome(this.userService.getHealthHome()).subscribe(e=>{if(200===e.status&&null!==e.body){let o=[];e.body.map(a=>{o.push({_id:a._id,name:a.name})}),this.nursesList=o}},e=>{console.log(e)})}saveTask(){var e,o,a,s,r,c,h;let f=this.formatDate(null===(e=this.taskFormGroup.get("date"))||void 0===e?void 0:e.value),u=null===(o=this.taskFormGroup.get("nurseSel"))||void 0===o?void 0:o.value;u=null===u?null:u._id;let d=null===(a=this.taskFormGroup.get("patientSel"))||void 0===a?void 0:a.value;d=null===d?null:d._id;let y={name:null===(s=this.taskFormGroup.get("title"))||void 0===s?void 0:s.value,description:null===(r=this.taskFormGroup.get("description"))||void 0===r?void 0:r.value,dateTime:f,status:null===(c=this.taskFormGroup.get("statusTask"))||void 0===c?void 0:c.value,assignedUser:u,assignedPatient:d,assignedHealthHome:this.userService.getHealthHome(),priority:null===(h=this.taskFormGroup.get("priority"))||void 0===h?void 0:h.value};this.taskService.createTask(y).subscribe(U=>{this.parentData.closeDialog()},U=>{console.log(U)})}formatDate(e){var o=""+(e.getMonth()+1),a=""+e.getDate(),s=e.getFullYear(),r=(e.getHours()<10?"0":"")+e.getHours(),c=(e.getMinutes()<10?"0":"")+e.getMinutes();return o.length<2&&(o="0"+o),a.length<2&&(a="0"+a),[s,o,a].join("-")+"T"+[r,c].join(":")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(N.eN),t.Y36(l.qu),t.Y36(b.K),t.Y36(T),t.Y36(M),t.Y36(g.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-crear-tarea"]],decls:38,vars:14,consts:[[1,"nav-1"],["mat-dialog-close",""],[3,"formGroup","ngSubmit"],["appearance","fill",1,"input"],["matInput","","formControlName","title","placeholder","Ej.: Cambiar suero","autocomplete","off"],["matInput","","formControlName","description","placeholder","Detalles sobre la tarea a realizar.","autocomplete","off"],["matInput","","placeholder","Choose a date","formControlName","date",3,"ngxMatDatetimePicker","min","disabled"],["matSuffix","",3,"for"],[3,"showSpinners","showSeconds","stepHour","stepMinute","touchUi"],["picker",""],["required","","name","statusTask","formControlName","statusTask"],[3,"value",4,"ngFor","ngForOf"],["name","nurseSel","formControlName","nurseSel"],["name","patientSel","formControlName","patientSel"],[1,"input"],["name","priority","formControlName","priority",1,"example-margin"],[1,"buttonDiv"],["type","submit","mat-raised-button","","color","primary",1,"login-element-width","button",3,"disabled"],[3,"value"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"mat-icon",1),t._uU(2,"cancel"),t.qZA(),t.qZA(),t.TgZ(3,"form",2),t.NdJ("ngSubmit",function(){return o.saveTask()}),t.TgZ(4,"mat-form-field",3),t.TgZ(5,"mat-label"),t._uU(6,"Nombre de la tarea"),t.qZA(),t._UZ(7,"input",4),t.qZA(),t.TgZ(8,"mat-form-field",3),t.TgZ(9,"mat-label"),t._uU(10,"Descripci\xf3n:"),t.qZA(),t._UZ(11,"input",5),t.qZA(),t.TgZ(12,"mat-form-field"),t._UZ(13,"input",6),t._UZ(14,"mat-datepicker-toggle",7),t._UZ(15,"ngx-mat-datetime-picker",8,9),t.qZA(),t.TgZ(17,"mat-form-field",3),t.TgZ(18,"mat-label"),t._uU(19,"Estado:"),t.qZA(),t.TgZ(20,"mat-select",10),t.YNc(21,Pt,2,2,"mat-option",11),t.qZA(),t.qZA(),t.TgZ(22,"mat-form-field",3),t.TgZ(23,"mat-label"),t._uU(24,"Asignar enfermero:"),t.qZA(),t.TgZ(25,"mat-select",12),t.YNc(26,qt,2,2,"mat-option",11),t.qZA(),t.qZA(),t.TgZ(27,"mat-form-field",3),t.TgZ(28,"mat-label"),t._uU(29,"Asignar paciente:"),t.qZA(),t.TgZ(30,"mat-select",13),t.YNc(31,Nt,2,2,"mat-option",11),t.qZA(),t.qZA(),t.TgZ(32,"div",14),t.TgZ(33,"mat-checkbox",15),t._uU(34,"\xbfEs prioritaria?"),t.qZA(),t.qZA(),t.TgZ(35,"div",16),t.TgZ(36,"button",17),t._uU(37," Guardar tarea "),t.qZA(),t.qZA(),t.qZA()),2&e){const a=t.MAs(16);t.xp6(3),t.Q6J("formGroup",o.taskFormGroup),t.xp6(10),t.Q6J("ngxMatDatetimePicker",a)("min",o.minDate)("disabled",o.disabled),t.xp6(1),t.Q6J("for",a),t.xp6(1),t.Q6J("showSpinners",o.showSpinners)("showSeconds",o.showSeconds)("stepHour",o.stepHour)("stepMinute",o.stepMinute)("touchUi",o.touchUi),t.xp6(6),t.Q6J("ngForOf",o.enumKeys),t.xp6(5),t.Q6J("ngForOf",o.nursesList),t.xp6(5),t.Q6J("ngForOf",o.patientsList),t.xp6(5),t.Q6J("disabled",o.taskFormGroup.invalid)}},directives:[x.Hw,g.ZT,l._Y,l.JL,l.sg,q.KE,q.hX,O.Nt,l.Fj,l.JJ,l.u,Q.g2,At.nW,q.R9,Q.AB,H.gD,l.Q7,_.sg,xt.oG,C.lW,F.ey],styles:[".body[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%;align-items:center}form[_ngcontent-%COMP%]{padding-top:24px}.img[_ngcontent-%COMP%]{width:50%;border-radius:45%;margin-bottom:15px}.login-element-width[_ngcontent-%COMP%]{width:80%}.button[_ngcontent-%COMP%]{height:50px;margin:8px 8px 8px 0}.mat-stepper-horizontal[_ngcontent-%COMP%]{margin-top:8px}.input[_ngcontent-%COMP%]{width:100%}.input-half[_ngcontent-%COMP%]{width:47%}.row[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.nav-1[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.nav-2[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.buttonDiv[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center}"]}),i})();function kt(i,n){1&i&&(t.TgZ(0,"div",5),t.TgZ(1,"h3"),t._uU(2,"No existen tareas."),t.qZA(),t.qZA())}function Dt(i,n){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Prioridad"),t.qZA())}function Yt(i,n){1&i&&(t.TgZ(0,"mat-icon",24),t._uU(1," arrow_upward "),t.qZA())}function wt(i,n){1&i&&(t.TgZ(0,"mat-icon",25),t._uU(1,"arrow_downward"),t.qZA())}function Ot(i,n){if(1&i&&(t.TgZ(0,"td",21),t.YNc(1,Yt,2,0,"mat-icon",22),t.YNc(2,wt,2,0,"mat-icon",23),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",e.priority),t.xp6(1),t.Q6J("ngIf",!e.priority)}}function Ht(i,n){1&i&&(t.TgZ(0,"th",20),t._uU(1,"T\xedtulo"),t.qZA())}function Ft(i,n){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.Oqu(e.name)}}function It(i,n){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Descripci\xf3n"),t.qZA())}function Mt(i,n){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.Oqu(e.description)}}function Qt(i,n){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Fecha"),t.qZA())}function Jt(i,n){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.Oqu(e.dateTime)}}function Lt(i,n){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Estado"),t.qZA())}function jt(i,n){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.status," ")}}function Gt(i,n){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Paciente"),t.qZA())}function Et(i,n){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.assignedPatient," ")}}function Bt(i,n){1&i&&(t.TgZ(0,"th",20),t._uU(1,"Enfermero"),t.qZA())}function $t(i,n){if(1&i&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.xp6(1),t.hij(" ",e.assignedUser," ")}}function zt(i,n){1&i&&t._UZ(0,"th",20)}function Rt(i,n){1&i&&(t.TgZ(0,"td",21),t.TgZ(1,"button",26),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA(),t.qZA(),t.qZA())}function Xt(i,n){1&i&&t._UZ(0,"th",20)}function Kt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"td",21),t.TgZ(1,"button",27,28),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw(2).deleteTask(s._id)}),t.TgZ(3,"mat-icon",29),t._uU(4,"delete"),t.qZA(),t.qZA(),t.qZA()}if(2&i){const e=n.$implicit;t.xp6(1),t.uIk("data-message-id",e._id)}}function Wt(i,n){1&i&&t._UZ(0,"tr",30)}function Vt(i,n){1&i&&t._UZ(0,"tr",31)}function te(i,n){if(1&i&&(t.TgZ(0,"table",6),t.ynx(1,7),t.YNc(2,Dt,2,0,"th",8),t.YNc(3,Ot,3,2,"td",9),t.BQk(),t.ynx(4,10),t.YNc(5,Ht,2,0,"th",8),t.YNc(6,Ft,2,1,"td",9),t.BQk(),t.ynx(7,11),t.YNc(8,It,2,0,"th",8),t.YNc(9,Mt,2,1,"td",9),t.BQk(),t.ynx(10,12),t.YNc(11,Qt,2,0,"th",8),t.YNc(12,Jt,2,1,"td",9),t.BQk(),t.ynx(13,13),t.YNc(14,Lt,2,0,"th",8),t.YNc(15,jt,2,1,"td",9),t.BQk(),t.ynx(16,14),t.YNc(17,Gt,2,0,"th",8),t._uU(18," //TODO "),t.YNc(19,Et,2,1,"td",9),t.BQk(),t.ynx(20,15),t.YNc(21,Bt,2,0,"th",8),t._uU(22," //TODO "),t.YNc(23,$t,2,1,"td",9),t.BQk(),t.ynx(24,16),t.YNc(25,zt,1,0,"th",8),t.YNc(26,Rt,4,0,"td",9),t.BQk(),t.ynx(27,17),t.YNc(28,Xt,1,0,"th",8),t.YNc(29,Kt,5,1,"td",9),t.BQk(),t.YNc(30,Wt,1,0,"tr",18),t.YNc(31,Vt,1,0,"tr",19),t.qZA()),2&i){const e=t.oxw();t.Q6J("dataSource",e.tareas),t.xp6(30),t.Q6J("matHeaderRowDef",e.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}const ee=[{path:"",component:G,children:[{path:"patients",component:St},{path:"tasks",component:(()=>{class i{constructor(e,o,a,s,r,c){this.taskService=e,this.dialog=o,this.userService=a,this.data=s,this.miscService=r,this.patientService=c,this.enumKeys=Object.keys(v),this.statusList=v,this.subscription=new k.w,this.mode="",this.title="",this.text="",this.displayedColumns=["priority","name","description","dateTime","assignedPatient","assignedUser","status","delete"],this.tareas=[]}ngOnInit(){this.getTasks(),this.subscription=this.data.currentMode.subscribe(e=>this.mode=e),this.subscription=this.data.currentTitle.subscribe(e=>this.title=e),this.subscription=this.data.currentText.subscribe(e=>this.text=e)}ngOnDestroy(){this.subscription.unsubscribe()}getTasks(){this.tareas=[],this.taskService.getTaskByHome(this.userService.getHealthHome()).subscribe(e=>{if(200===e.status&&null!==e.body){this.tareas=e.body;let o=[];e.body.forEach(a=>{var s,r;a.assignedUser=(null===(s=this.userService.getNursesLocal().find(c=>c._id===a.assignedUser))||void 0===s?void 0:s.name)||"",a.assignedPatient=(null===(r=this.patientService.getPatientsLocal().find(c=>c._id===a.assignedPatient))||void 0===r?void 0:r.name)||"",a.dateTime=this.formatDate(a.dateTime),o.push(a)}),this.tareas=o}},e=>{console.log(e)})}createTask(){const e=this.dialog.open(Ut,{height:"80%",width:"700px",data:{closeDialog:()=>{e.close()}}});e.afterClosed().subscribe(o=>{this.ngOnInit()})}deleteTask(e){this.taskService.deleteTaskById(e).subscribe(o=>{200===o.status&&(this.data.changeDialog("show","\xc9xito","Se elimino la tarea satisfactoriamente."),this.dialog.open(I),this.ngOnInit())})}formatDate(e){let o=new Date(e);var a=""+(o.getMonth()+1),s=""+o.getDate(),r=o.getFullYear(),c=o.getHours()+3,h=(c<10?"0":"")+c,f=(o.getMinutes()<10?"0":"")+o.getMinutes();return a.length<2&&(a="0"+a),s.length<2&&(s="0"+s),[s,a,r].join("/")+" "+[h,f].join(":")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(M),t.Y36(g.uw),t.Y36(b.K),t.Y36(D.D),t.Y36(A),t.Y36(T))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-tareas"]],decls:9,vars:2,consts:[[1,"content"],[1,"row"],["mat-fab","","color","primary","aria-label","Crear tarea",3,"click"],["class","mensaje",4,"ngIf"],["mat-table","","class","mat-elevation-z8",3,"dataSource",4,"ngIf"],[1,"mensaje"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","priority"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","description"],["matColumnDef","dateTime"],["matColumnDef","status"],["matColumnDef","assignedPatient"],["matColumnDef","assignedUser"],["matColumnDef","edit"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["style","color: red",4,"ngIf"],["style","color: green",4,"ngIf"],[2,"color","red"],[2,"color","green"],["mat-icon-button",""],["mat-icon-button","",3,"click"],["element._id",""],["color","warn"],["mat-header-row",""],["mat-row",""]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h1"),t._uU(3,"Tareas"),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return o.createTask()}),t.TgZ(5,"mat-icon"),t._uU(6,"add"),t.qZA(),t.qZA(),t.qZA(),t.YNc(7,kt,3,0,"div",3),t.YNc(8,te,32,3,"table",4),t.qZA()),2&e&&(t.xp6(7),t.Q6J("ngIf",0===o.tareas.length),t.xp6(1),t.Q6J("ngIf",o.tareas.length>0))},directives:[C.lW,x.Hw,_.O5,p.BZ,p.w1,p.fO,p.Dz,p.as,p.nj,p.ge,p.ev,p.XQ,p.Gk],styles:[".content[_ngcontent-%COMP%]{padding:20px}.content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}",".mensaje[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center}table[_ngcontent-%COMP%]{width:100%}"]}),i})()}]}];let ie=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[S.Bz.forChild(ee)],S.Bz]}),i})(),oe=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[_.ez,ie,J.m]]}),i})()}}]);